{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block title %}Ø¬Ø²Ø¦ÛŒØ§Øª Ø¢Ø¯Ø±Ø³ {{ address.assignment_id }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block extrahead %}{{ block.super }}
<style>
    .detail-card {
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
    }
    .detail-row {
        display: flex;
        margin-bottom: 10px;
        padding: 8px 0;
        border-bottom: 1px solid #f0f0f0;
    }
    .detail-label {
        font-weight: bold;
        width: 200px;
        color: #666;
    }
    .detail-value {
        flex: 1;
    }
    .status-badge {
        padding: 6px 12px;
        border-radius: 4px;
        color: white;
        font-size: 14px;
        font-weight: bold;
    }
    .status-pending { background-color: #ffc107; color: #000; }
    .status-sent_to_delivery { background-color: #17a2b8; }
    .status-delivery_created { background-color: #28a745; }
    .status-completed { background-color: #6c757d; }
    .vehicle-types {
        display: flex;
        gap: 8px;
    }
    .vehicle-type {
        padding: 4px 8px;
        background: #e9ecef;
        border-radius: 4px;
        font-size: 12px;
    }
</style>
{% endblock %}

{% block content %}
<div id="content-main">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Ø¬Ø²Ø¦ÛŒØ§Øª Ø¢Ø¯Ø±Ø³ {{ address.assignment_id }}</h1>
        <div>
            <a href="{% url 'marketplace:address_list' %}" class="btn btn-secondary">
                â†©ï¸ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª
            </a>
            {% if address.status == 'pending' %}
            <form method="post" action="{% url 'marketplace:single_send_to_delivery' address.id %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-success" onclick="return confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')">
                    ğŸ“¤ Ø§Ø±Ø³Ø§Ù„ Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø­ÙˆØ§Ù„Ù‡
                </button>
            </form>
            {% endif %}
        </div>
    </div>
    
    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ù„ÛŒ -->
    <div class="detail-card">
        <h3>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ù„ÛŒ</h3>
        
        <div class="detail-row">
            <div class="detail-label">Ø´Ù†Ø§Ø³Ù‡ ØªØ®ØµÛŒØµ:</div>
            <div class="detail-value"><strong>{{ address.assignment_id }}</strong></div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">ÙˆØ¶Ø¹ÛŒØª:</div>
            <div class="detail-value">
                <span class="status-badge status-{{ address.status }}">
                    {{ address.get_status_display }}
                </span>
            </div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ú©Ø¯:</div>
            <div class="detail-value">{{ address.code }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">ÙˆØ²Ù† Ø³ÙØ§Ø±Ø´:</div>
            <div class="detail-value">{{ address.order_weight }} Kg</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">ÙˆØ²Ù† Ú©Ù„ Ø®Ø±ÛŒØ¯:</div>
            <div class="detail-value">{{ address.total_purchase_weight }} Kg</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">ØªØ§Ø±ÛŒØ® Ø®Ø±ÛŒØ¯:</div>
            <div class="detail-value">{{ address.purchase_date|date:"Y/m/d" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª Ø¢Ø¯Ø±Ø³:</div>
            <div class="detail-value">{{ address.address_registration_date|date:"Y/m/d" }}</div>
        </div>
        
        {% if address.delivery_order_number %}
        <div class="detail-row">
            <div class="detail-label">Ø´Ù…Ø§Ø±Ù‡ Ø­ÙˆØ§Ù„Ù‡:</div>
            <div class="detail-value">
                <a href="/admin/warehouse/warehousedeliveryorder/?number={{ address.delivery_order_number }}" target="_blank">
                    {{ address.delivery_order_number }}
                </a>
            </div>
        </div>
        {% endif %}
    </div>
    
    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø®Ø±ÛŒØ¯Ø§Ø± -->
    <div class="detail-card">
        <h3>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø®Ø±ÛŒØ¯Ø§Ø±</h3>
        
        <div class="detail-row">
            <div class="detail-label">Ù†Ø§Ù… Ø®Ø±ÛŒØ¯Ø§Ø±:</div>
            <div class="detail-value">{{ address.buyer_name }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø´Ù†Ø§Ø³Ù‡ Ù…Ù„ÛŒ Ø®Ø±ÛŒØ¯Ø§Ø±:</div>
            <div class="detail-value">{{ address.buyer_national_id|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø´Ù…Ø§Ø±Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ø®Ø±ÛŒØ¯Ø§Ø±:</div>
            <div class="detail-value">{{ address.buyer_mobile|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø¢Ø¯Ø±Ø³ Ø®Ø±ÛŒØ¯Ø§Ø±:</div>
            <div class="detail-value">{{ address.buyer_address|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ú©Ø¯ Ù¾Ø³ØªÛŒ Ø®Ø±ÛŒØ¯Ø§Ø±:</div>
            <div class="detail-value">{{ address.buyer_postal_code|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ù†ÙˆØ¹ Ú©Ø§Ø±Ø¨Ø±ÛŒ:</div>
            <div class="detail-value">{{ address.get_buyer_user_type_display }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø´Ù…Ø§Ø±Ù‡ Ø­Ø³Ø§Ø¨:</div>
            <div class="detail-value">{{ address.buyer_account_number|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø´Ù†Ø§Ø³Ù‡ ÛŒÚ©ØªØ§:</div>
            <div class="detail-value">{{ address.buyer_unique_id|default:"-" }}</div>
        </div>
    </div>
    
    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªØ­ÙˆÛŒÙ„ Ú¯ÛŒØ±Ù†Ø¯Ù‡ -->
    <div class="detail-card">
        <h3>Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªØ­ÙˆÛŒÙ„ Ú¯ÛŒØ±Ù†Ø¯Ù‡</h3>
        
        <div class="detail-row">
            <div class="detail-label">Ù†Ø§Ù… ØªØ­ÙˆÛŒÙ„ Ú¯ÛŒØ±Ù†Ø¯Ù‡:</div>
            <div class="detail-value">{{ address.recipient_name }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø´Ù†Ø§Ø³Ù‡ ÛŒÚ©ØªØ§ÛŒ ØªØ­ÙˆÛŒÙ„:</div>
            <div class="detail-value">{{ address.recipient_unique_id|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø¢Ø¯Ø±Ø³ ØªØ­ÙˆÛŒÙ„:</div>
            <div class="detail-value">{{ address.delivery_address }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ú©Ø¯ Ù¾Ø³ØªÛŒ ØªØ­ÙˆÛŒÙ„:</div>
            <div class="detail-value">{{ address.delivery_postal_code|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø§Ø³ØªØ§Ù†:</div>
            <div class="detail-value">{{ address.province }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø´Ù‡Ø±:</div>
            <div class="detail-value">{{ address.city }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø´Ù…Ø§Ø±Ù‡ Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ:</div>
            <div class="detail-value">{{ address.coordination_phone|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ú©Ø¯ Ù…Ù„ÛŒ ØªØ­ÙˆÛŒÙ„:</div>
            <div class="detail-value">{{ address.delivery_national_id|default:"-" }}</div>
        </div>
    </div>
    
    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ³ÛŒÙ„Ù‡ Ø­Ù…Ù„ -->
    <div class="detail-card">
        <h3>Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ³ÛŒÙ„Ù‡ Ø­Ù…Ù„</h3>
        
        <div class="detail-row">
            <div class="detail-label">Ù†ÙˆØ¹ ÙˆØ³ÛŒÙ„Ù‡ Ø­Ù…Ù„:</div>
            <div class="detail-value">
                <div class="vehicle-types">
                    {% if address.vehicle_single %}<span class="vehicle-type">ØªÚ©</span>{% endif %}
                    {% if address.vehicle_double %}<span class="vehicle-type">Ø¬ÙØª</span>{% endif %}
                    {% if address.vehicle_trailer %}<span class="vehicle-type">ØªØ±ÛŒÙ„ÛŒ</span>{% endif %}
                    {% if not address.vehicle_single and not address.vehicle_double and not address.vehicle_trailer %}
                        <span class="text-muted">ØªØ¹ÛŒÛŒÙ† Ù†Ø´Ø¯Ù‡</span>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§Ù„ÛŒ -->
    <div class="detail-card">
        <h3>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§Ù„ÛŒ</h3>
        
        <div class="detail-row">
            <div class="detail-label">Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ:</div>
            <div class="detail-value">{{ address.paid_amount|floatformat:0 }} Ø±ÛŒØ§Ù„</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ù‚ÛŒÙ…Øª Ù‡Ø± ÙˆØ§Ø­Ø¯:</div>
            <div class="detail-value">{{ address.unit_price|floatformat:0 }} Ø±ÛŒØ§Ù„</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø´ÛŒÙˆÙ‡ Ù¾Ø±Ø¯Ø§Ø®Øª:</div>
            <div class="detail-value">{{ address.payment_method|default:"-" }}</div>
        </div>
        
        {% if address.payment_period_1_days %}
        <div class="detail-row">
            <div class="detail-label">Ø¨Ø§Ø²Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª ØªÙˆØ§ÙÙ‚ÛŒ:</div>
            <div class="detail-value">
                {% if address.payment_period_1_days %}
                    Ø¨Ø§Ø²Ù‡ 1: {{ address.payment_period_1_days }} Ø±ÙˆØ² - {{ address.payment_amount_1|floatformat:0 }} Ø±ÛŒØ§Ù„<br>
                {% endif %}
                {% if address.payment_period_2_days %}
                    Ø¨Ø§Ø²Ù‡ 2: {{ address.payment_period_2_days }} Ø±ÙˆØ² - {{ address.payment_amount_2|floatformat:0 }} Ø±ÛŒØ§Ù„<br>
                {% endif %}
                {% if address.payment_period_3_days %}
                    Ø¨Ø§Ø²Ù‡ 3: {{ address.payment_period_3_days }} Ø±ÙˆØ² - {{ address.payment_amount_3|floatformat:0 }} Ø±ÛŒØ§Ù„<br>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>
    
    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ù„Ø§ -->
    <div class="detail-card">
        <h3>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ù„Ø§</h3>
        
        <div class="detail-row">
            <div class="detail-label">Ø¹Ù†ÙˆØ§Ù† Ú©Ø§Ù„Ø§:</div>
            <div class="detail-value">{{ address.product_title }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ú©Ø¯ Ú©ÙˆØªØ§Ú˜:</div>
            <div class="detail-value">{{ address.cottage_code|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø´Ù†Ø§Ø³Ù‡ Ø¹Ø±Ø¶Ù‡:</div>
            <div class="detail-value">{{ address.offer_id|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø´Ù…Ø§Ø±Ù‡ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ:</div>
            <div class="detail-value">{{ address.tracking_number|default:"-" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">ØªÙˆØ¶ÛŒØ­Ø§Øª:</div>
            <div class="detail-value">{{ address.description|default:"-" }}</div>
        </div>
    </div>
    
    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§Ø±Ù†Ø§Ù…Ù‡ -->
    {% if address.shipped_weight or address.unshipped_weight %}
    <div class="detail-card">
        <h3>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§Ø±Ù†Ø§Ù…Ù‡</h3>
        
        <div class="detail-row">
            <div class="detail-label">ÙˆØ²Ù† Ø¨Ø§Ø±Ù†Ø§Ù…Ù‡ Ø´Ø¯Ù‡:</div>
            <div class="detail-value">{{ address.shipped_weight }} Kg</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">ÙˆØ²Ù† Ø¨Ø§Ø±Ù†Ø§Ù…Ù‡ Ù†Ø´Ø¯Ù‡:</div>
            <div class="detail-value">{{ address.unshipped_weight }} Kg</div>
        </div>
    </div>
    {% endif %}
    
    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÛŒØ³ØªÙ… -->
    <div class="detail-card">
        <h3>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÛŒØ³ØªÙ…</h3>
        
        <div class="detail-row">
            <div class="detail-label">ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯:</div>
            <div class="detail-value">{{ address.created_at|date:"Y/m/d H:i:s" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø¢Ø®Ø±ÛŒÙ† ÙˆÛŒØ±Ø§ÛŒØ´:</div>
            <div class="detail-value">{{ address.updated_at|date:"Y/m/d H:i:s" }}</div>
        </div>
        
        <div class="detail-row">
            <div class="detail-label">Ø®Ø±ÛŒØ¯ Ù…Ø±ØªØ¨Ø·:</div>
            <div class="detail-value">
                <a href="/admin/marketplace/marketplacepurchasedetail/{{ address.purchase_detail.id }}/change/" target="_blank">
                    {{ address.purchase_detail.purchase.purchase_id }} - {{ address.purchase_detail.purchase.buyer_name }}
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}